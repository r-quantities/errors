<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Measurement Errors in R • errors</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Measurement Errors in R">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">errors</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/rjournal.html">Measurement Errors in R</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-quantities/errors/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Measurement Errors in R</h1>
                        <h4 data-toc-skip class="author">Iñaki Ucar,
Edzer Pebesma, Arturo Azcorra</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/r-quantities/errors/blob/v0.4.3/vignettes/rjournal.Rmd" class="external-link"><code>vignettes/rjournal.Rmd</code></a></small>
      <div class="d-none name"><code>rjournal.Rmd</code></div>
    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>This paper presents an R package to handle and represent
      measurements with errors in a very simple way. We briefly
      introduce the main concepts of metrology and propagation of
      uncertainty, and discuss related R packages. Building upon this,
      we introduce the <strong>errors</strong> package, which provides a
      class for associating uncertainty metadata, automated propagation
      and reporting. Working with <strong>errors</strong> enables
      transparent, lightweight, less error-prone handling and convenient
      representation of measurements with errors. Finally, we discuss
      the advantages, limitations and future work of computing with
      errors.</p>
    </div>
    
<div style="display:none">
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow></mrow><annotation encoding="application/x-tex">\newcommand{\E}{\mathbb{E}}</annotation></semantics></math></p>
</div>
<p>This manuscript corresponds to <code>errors</code> version 0.4.3 and
was typeset on 2025-01-18.<br>
For citations, please use the version published in the R Journal (see
<code>citation("errors")</code>).</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The International Vocabulary of Metrology (VIM) defines a
<em>quantity</em> as “a property of a phenomenon, body, or substance,
where the property has a magnitude that can be expressed as a number and
a reference”, where most typically the number is a <em>quantity
value</em>, attributed to a <em>measurand</em> and experimentally
obtained via some measurement procedure, and the reference is a
<em>measurement unit</em> <span class="citation">(<a href="#ref-VIM:2012">BIPM et al. 2012</a>)</span>.</p>
<p>Additionally, any quantity value must accommodate some indication
about the quality of the measurement, a quantifiable attribute known as
<em>uncertainty</em>. The Guide to the Expression of Uncertainty in
Measurement (GUM) defines <em>uncertainty</em> as “a parameter,
associated with the result of a measurement, that characterises the
dispersion of the values that could reasonably be attributed to the
measurand” <span class="citation">(<a href="#ref-GUM:2008">BIPM et al.
2008</a>)</span>. Uncertainty can be mainly classified into <em>standard
uncertainty</em>, which is the result of a direct measurement (e.g.,
electrical voltage measured with a voltmeter, or current measured with a
amperemeter), and <em>combined standard uncertainty</em>, which is the
result of an indirect measurement (i.e., the standard uncertainty when
the result is derived from a number of other quantities by the means of
some mathematical relationship; e.g., electrical power as a product of
voltage and current). Therefore, provided a set of quantities with known
uncertainties, the process of obtaining the uncertainty of a derived
measurement is called <em>propagation of uncertainty</em>.</p>
<p>Traditionally, computational systems have treated these three
components (quantity values, measurement units and uncertainty)
separately. Data consisted of bare numbers, and mathematical operations
applied to them solely. Units were just metadata, and uncertainty
propagation was an unpleasant task requiring additional effort and
complex operations. Nowadays though, many software libraries have
formalised <em>quantity calculus</em> as method of including units
within the scope of mathematical operations, thus preserving dimensional
correctness and protecting us from computing nonsensical combinations of
quantities. However, these libraries rarely integrate uncertainty
handling and propagation <span class="citation">(<a href="#ref-Flatter:2018">Flater 2018</a>)</span>.</p>
<p>Within the R environment, the <strong>units</strong> package <span class="citation">(<a href="#ref-CRAN:units">Pebesma and Mailund
2017</a>; <a href="#ref-Pebesma:2016:units">Pebesma, Mailund, and
Hiebert 2016</a>)</span> defines a class for associating unit metadata
to numeric vectors, which enables transparent quantity derivation,
simplification and conversion. This approach is a very comfortable way
of managing units with the added advantage of eliminating an entire
class of potential programming mistakes. Unfortunately, neither
<strong>units</strong> nor any other package address the integration of
uncertainties into quantity calculus.</p>
<p>This article presents <strong>errors</strong> <span class="citation">(<a href="#ref-CRAN:errors">Ucar 2018</a>)</span>, a
package that defines a framework for associating uncertainty metadata to
R vectors, matrices and arrays, thus providing transparent, lightweight
and automated propagation of uncertainty. This implementation also
enables ongoing developments for integrating units and uncertainty
handling into a complete solution.</p>
</div>
<div class="section level2">
<h2 id="propagation-of-uncertainty">Propagation of uncertainty<a class="anchor" aria-label="anchor" href="#propagation-of-uncertainty"></a>
</h2>
<p>There are two main methods for propagation of uncertainty: the
<em>Taylor series method</em> (TSM) and the <em>Monte Carlo method</em>
(MCM). The TSM, also called the <em>delta method</em>, is based on a
Taylor expansion of the mathematical expression that produces the output
variables. As for the MCM, it can deal with generalised input
distributions and propagates the uncertainty by Monte Carlo
simulation.</p>
<div class="section level3">
<h3 id="taylor-series-method">Taylor series method<a class="anchor" aria-label="anchor" href="#taylor-series-method"></a>
</h3>
<p>The TSM is a flexible and simple method of propagation of uncertainty
that offers a good degree of approximation in most cases. In the
following, we will provide a brief description. A full derivation,
discussion and examples can be found in <span class="citation">Arras (<a href="#ref-Arras:1998">1998</a>)</span>.</p>
<p>Mathematically, an indirect measurement is obtained as a function of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
direct or indirect measurements,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>X</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Y = f(X_1, ..., X_n)</annotation></semantics></math>,
where the distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>n</mi></msub><annotation encoding="application/x-tex">X_n</annotation></semantics></math>
is unknown <em>a priori</em>. Usually, the sources of random variability
are many, independent and probably unknown as well. Thus, the central
limit theorem establishes that an addition of a sufficiently large
number of random variables tends to a normal distribution. As a result,
the <strong>first assumption</strong> states that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>n</mi></msub><annotation encoding="application/x-tex">X_n</annotation></semantics></math>
are normally distributed.</p>
<p>The <strong>second assumption</strong> presumes linearity, i.e., that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math>
can be approximated by a first-order Taylor series expansion around
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><msub><mi>X</mi><mi>n</mi></msub></msub><annotation encoding="application/x-tex">\mu_{X_n}</annotation></semantics></math>
(see Figure 1). Then, given a set of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
input variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
and a set of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
output variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>,
the first-order <em>uncertainty propagation law</em> establishes that
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Σ</mi><mi>Y</mi></msub><mo>=</mo><msub><mi>J</mi><mi>X</mi></msub><msub><mi>Σ</mi><mi>X</mi></msub><msubsup><mi>J</mi><mi>X</mi><mi>T</mi></msubsup></mrow><annotation encoding="application/x-tex">\begin{equation*}
\Sigma_Y = J_X \Sigma_X J_X^T \tag{1}
\end{equation*}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Σ</mi><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math>
is the covariance matrix and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>
is the Jacobian operator.</p>
<div class="figure" style="text-align: center">
<img src="rjournal_files/figure-html/propagation-1.png" alt="Figure 1: Illustration of linearity in an interval $\pm$ one standard deviation around the mean." width="50%"><p class="caption">
Figure 1: Illustration of linearity in an interval
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math>
one standard deviation around the mean.
</p>
</div>
<p>In practice, as recommended in the GUM <span class="citation">(<a href="#ref-GUM:2008">BIPM et al. 2008</a>)</span>, this first-order
approximation is good even if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math>
is non-linear, provided that the non-linearity is negligible compared to
the magnitude of the uncertainty, i.e., <span class="math inline">$\E[f(X)]\approx f(\E[X])$</span>. Also, this weaker
condition is distribution-free: no assumptions are needed on the
probability density functions (PDF) of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>n</mi></msub><annotation encoding="application/x-tex">X_n</annotation></semantics></math>,
although they must be reasonably symmetric.</p>
<p>If we consider Equation (1) for pairwise computations, i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msub><mi>X</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Y = f(X_1, X_2)</annotation></semantics></math>,
we can write the propagation of the uncertainty
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mi>Y</mi></msub><annotation encoding="application/x-tex">\sigma_Y</annotation></semantics></math>
as follows:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>σ</mi><mi>Y</mi><mn>2</mn></msubsup><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><msup><mi>∂</mi><mn>2</mn></msup><mi>f</mi></mrow><mrow><mi>∂</mi><msubsup><mi>X</mi><mn>1</mn><mn>2</mn></msubsup></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><msubsup><mi>σ</mi><msub><mi>X</mi><mn>1</mn></msub><mn>2</mn></msubsup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><msup><mi>∂</mi><mn>2</mn></msup><mi>f</mi></mrow><mrow><mi>∂</mi><msubsup><mi>X</mi><mn>2</mn><mn>2</mn></msubsup></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><msubsup><mi>σ</mi><msub><mi>X</mi><mn>2</mn></msub><mn>2</mn></msubsup><mo>+</mo><mn>2</mn><mfrac><mrow><mi>∂</mi><mi>f</mi><mi>∂</mi><mi>f</mi></mrow><mrow><mi>∂</mi><msub><mi>X</mi><mn>1</mn></msub><mi>∂</mi><msub><mi>X</mi><mn>2</mn></msub></mrow></mfrac><msub><mi>σ</mi><mrow><msub><mi>X</mi><mn>1</mn></msub><msub><mi>X</mi><mn>2</mn></msub></mrow></msub></mrow><annotation encoding="application/x-tex">\begin{equation*}
  \sigma_Y^2 = \left(\frac{\partial^2 f}{\partial X_1^2}\right)^2 \sigma_{X_1}^2 +
               \left(\frac{\partial^2 f}{\partial X_2^2}\right)^2 \sigma_{X_2}^2 +
               2 \frac{\partial f \partial f}{\partial X_1 \partial X_2} \sigma_{X_1 X_2}
  \tag{2}
\end{equation*}</annotation></semantics></math></p>
<p>The cross-covariances for the output
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
and any other variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Z</mi><annotation encoding="application/x-tex">Z</annotation></semantics></math>
can be simplified as follows:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><mrow><mi>Y</mi><mi>Z</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi>∂</mi><mi>f</mi></mrow><mrow><mi>∂</mi><msub><mi>X</mi><mn>1</mn></msub></mrow></mfrac><msub><mi>σ</mi><mrow><msub><mi>X</mi><mn>1</mn></msub><mi>Z</mi></mrow></msub><mo>+</mo><mfrac><mrow><mi>∂</mi><mi>f</mi></mrow><mrow><mi>∂</mi><msub><mi>X</mi><mn>2</mn></msub></mrow></mfrac><msub><mi>σ</mi><mrow><msub><mi>X</mi><mn>2</mn></msub><mi>Z</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\begin{equation*}
  \sigma_{Y Z} = \frac{\partial f}{\partial X_1} \sigma_{X_1 Z} +
                 \frac{\partial f}{\partial X_2} \sigma_{X_2 Z}
  \tag{3}
\end{equation*}</annotation></semantics></math> where, notably, if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>=</mo><msub><mi>X</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">Z=X_i</annotation></semantics></math>,
one of the covariances above results in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>σ</mi><msub><mi>X</mi><mi>i</mi></msub><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma_{X_i}^2</annotation></semantics></math>.
Finally, and for the sake of completeness, the correlation coefficient
can be obtained as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mrow><mi>Y</mi><mi>Z</mi></mrow></msub><mo>=</mo><msub><mi>σ</mi><mrow><mi>Y</mi><mi>Z</mi></mrow></msub><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>σ</mi><mi>Y</mi></msub><msub><mi>σ</mi><mi>Z</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">r_{Y Z} = \sigma_{Y Z} / (\sigma_{Y}\sigma_{Z})</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="monte-carlo-method">Monte Carlo method<a class="anchor" aria-label="anchor" href="#monte-carlo-method"></a>
</h3>
<p>The MCM is based on the same principles underlying the TSM. It is
based on the propagation of the PDFs of the input variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>n</mi></msub><annotation encoding="application/x-tex">X_n</annotation></semantics></math>
by performing random sampling and evaluating them under the model
considered. Thus, this method is not constrained by the TSM assumptions,
and explicitly determines a PDF for the output quantity
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>,
which makes it a more general approach that applies to a broader set of
problems. For further details on this method, as well as a comparison
with the TSM and some discussion on the applicability of both methods,
the reader may refer to the Supplement 1 of the GUM <span class="citation">(<a href="#ref-GUM:2008">BIPM et al.
2008</a>)</span>.</p>
</div>
</div>
<div class="section level2">
<h2 id="reporting-uncertainty">Reporting uncertainty<a class="anchor" aria-label="anchor" href="#reporting-uncertainty"></a>
</h2>
<p>The GUM <span class="citation">(<a href="#ref-GUM:2008">BIPM et al.
2008</a>)</span> defines four ways of reporting standard uncertainty and
combined standard uncertainty. For instance, if the reported quantity is
assumed to be a mass
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>m</mi><mi>S</mi></msub><annotation encoding="application/x-tex">m_S</annotation></semantics></math>
of nominal value 100 g:</p>
<blockquote>
<ol style="list-style-type: decimal">
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>S</mi></msub><mo>=</mo><mn>100.02147</mn></mrow><annotation encoding="application/x-tex">m_S = 100.02147</annotation></semantics></math>
g with (a combined standard uncertainty)
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>u</mi><mi>c</mi></msub><annotation encoding="application/x-tex">u_c</annotation></semantics></math>
= 0.35 mg.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>S</mi></msub><mo>=</mo><mn>100.02147</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>35</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">m_S = 100.02147(35)</annotation></semantics></math>
g, where the number in parentheses is the numerical value of (the
combined standard uncertainty)
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>u</mi><mi>c</mi></msub><annotation encoding="application/x-tex">u_c</annotation></semantics></math>
referred to the corresponding last digits of the quoted result.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>S</mi></msub><mo>=</mo><mn>100.02147</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.00035</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">m_S = 100.02147(0.00035)</annotation></semantics></math>
g, where the number in parentheses is the numerical value of (the
combined standard uncertainty)
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>u</mi><mi>c</mi></msub><annotation encoding="application/x-tex">u_c</annotation></semantics></math>
expressed in the unit of the quoted result.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>S</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>100.02147</mn><mo>±</mo><mn>0.00035</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">m_S = (100.02147 \pm 0.00035)</annotation></semantics></math>
g, where the number following the symbol
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math>
is the numerical value of (the combined standard uncertainty)
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>u</mi><mi>c</mi></msub><annotation encoding="application/x-tex">u_c</annotation></semantics></math>
and not a confidence interval.</li>
</ol>
</blockquote>
<p>Schemes (2, 3) and (4) would be referred to as <em>parenthesis</em>
notation and <em>plus-minus</em> notation respectively throughout this
document. Although (4) is a very extended notation, the GUM explicitly
discourages its use to prevent confusion with confidence intervals.</p>
</div>
<div class="section level2">
<h2 id="related-work">Related work<a class="anchor" aria-label="anchor" href="#related-work"></a>
</h2>
<p>Several R packages are devoted to or provide methods for propagation
of uncertainties. The <strong>car</strong> <span class="citation">(<a href="#ref-CRAN:car">Fox and Weisberg 2016</a>, <a href="#ref-Fox:2011:car">2011</a>)</span> and <strong>msm</strong> <span class="citation">(<a href="#ref-CRAN:msm">C. Jackson 2016</a>; <a href="#ref-Jackson:2011:msm">C. H. Jackson 2011</a>)</span> packages
provide the functions <code>deltaMethod()</code> and
<code>deltamethod()</code> respectively. Both of them implement a
first-order TSM with a similar syntax, requiring a formula, a vector of
values and a covariance matrix, thus being able to deal with dependency
across variables.</p>
<p>The <strong>metRology</strong> <span class="citation">(<a href="#ref-CRAN:metRology">Ellison 2017</a>)</span> and
<strong>propagate</strong> <span class="citation">(<a href="#ref-CRAN:propagate">Spiess 2014</a>)</span> packages stand out as
very comprehensive sets of tools specifically focused on this topic,
including both TSM and MCM. The <strong>metRology</strong> package
implements TSM using algebraic or numeric differentiation, with support
for correlation. It also provides a function for assessing the
statistical performance of GUM uncertainty (TSM) using attained coverage
probability. The <strong>propagate</strong> package implements TSM up to
second order. It provides a unified interface for both TSM and MCM
through the <code>propagate()</code> function, which requires an
expression and a data frame or matrix as input. Unfortunately, as in the
case of <strong>car</strong> and <strong>msm</strong>, these packages
are limited to work only with expressions, which does not solve the
issue of requiring a separate workflow to deal with uncertainties.</p>
<p>The <strong>spup</strong> package <span class="citation">(<a href="#ref-CRAN:spup">Sawicka and Heuvelink 2017</a>)</span> focuses on
uncertainty analysis in spatial environmental modelling, where the
spatial cross-correlation between variables becomes important. The
uncertainty is described with probability distributions and propagated
using MCM.</p>
<p>Finally, the <strong>distr</strong> package <span class="citation">(<a href="#ref-CRAN:distr">Kohl 2017</a>; <a href="#ref-Ruckdeschel:2006:distr">Ruckdeschel et al. 2006</a>)</span>
takes this idea one step further by providing an S4-based
object-oriented implementation of probability distributions, with which
one can operate arithmetically or apply mathematical functions. It
implements all kinds of probability distributions and has more methods
for computing the distribution of derived quantities. Also,
<strong>distr</strong> is the base of a whole family of packages, such
as <strong>distrEllipse</strong>, <strong>distrEx</strong>,
<strong>distrMod</strong>, <strong>distrRmetrics</strong>,
<strong>distrSim</strong> and <strong>distrTeach</strong>.</p>
<p>All these packages provide excellent tools for uncertainty analysis
and propagation. However, none of them addresses the issue of an
integrated workflow, as <strong>units</strong> does for unit metadata by
assigning units directly to R vectors, matrices and arrays. As a result,
units can be added to any existing R computation in a very
straightforward way. On the other hand, existing tools for uncertainty
propagation require building specific expressions or data structures,
and then some more work to extract the results out and to report them
properly, with an appropriate number of significant digits.</p>
</div>
<div class="section level2">
<h2 id="automated-uncertainty-handling-in-r-the-errors-package">Automated uncertainty handling in R: the <strong>errors</strong>
package<a class="anchor" aria-label="anchor" href="#automated-uncertainty-handling-in-r-the-errors-package"></a>
</h2>
<p>The <strong>errors</strong> package aims to provide easy and
lightweight handling of measurement with errors, including uncertainty
propagation using the first-order TSM presented in the previous section
and a formally sound representation.</p>
<div class="section level3">
<h3 id="package-description-and-usage">Package description and usage<a class="anchor" aria-label="anchor" href="#package-description-and-usage"></a>
</h3>
<p>Standard uncertainties, can be assigned to numeric vectors, matrices
and arrays, and then all the mathematical and arithmetic operations are
transparently applied to both the values and the associated
uncertainties:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-quantities.github.io/errors/" class="external-link">errors</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">5</span>, sd <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">5</span>, sd <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/errors.html">errors</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0.01</span></span>
<span><span class="fu"><a href="../reference/errors.html">errors</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0.02</span></span>
<span><span class="va">x</span>; <span class="va">y</span></span></code></pre></div>
<pre><code><span><span class="co">## Errors: 0.01 0.01 0.01 0.01 0.01</span></span>
<span><span class="co">## [1] 0.9859996 2.0025532 2.9756274 3.9999443 5.0062155</span></span></code></pre>
<pre><code><span><span class="co">## Errors: 0.02 0.02 0.02 0.02 0.02</span></span>
<span><span class="co">## [1] 1.022968 1.963564 2.995053 3.995116 4.994346</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">z</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">/</span> <span class="va">y</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Errors: 0.021229025 0.011569056 0.007427156 0.005602416 0.004485713</span></span>
<span><span class="co">## [1] 0.9638614 1.0198565 0.9935139 1.0012085 1.0023766</span></span></code></pre>
<p>The <code><a href="../reference/errors.html">errors()</a></code> method assigns or retrieves a vector of
uncertainties, which is stored as an attribute of the class
<code>errors</code>, along with a unique object identifier:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  Errors: num [1:5] 0.99(1) 2.00(1) 2.98(1) 4.00(1) 5.01(1)</span></span></code></pre>
<p>Correlations (and thus covariances) between pairs of variables can be
set and retrieved using the <code><a href="../reference/correl.html">correl()</a></code> and
<code><a href="../reference/correl.html">covar()</a></code> methods. These correlations are stored in an
internal hash table indexed by the unique object identifier assigned to
each <code>errors</code> object. If an object is removed, its associated
correlations are cleaned up automatically.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/correl.html">correl</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">x</span><span class="op">)</span> <span class="co"># one, cannot be changed</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1 1 1 1 1</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/correl.html">correl</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="co"># NULL, not defined yet</span></span></code></pre></div>
<pre><code><span><span class="co">## NULL</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/correl.html">correl</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/correl.html">correl</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -0.4202154  0.3567609  0.4706392 -0.6080865  0.9610793</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/correl.html">covar</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -8.404308e-05  7.135217e-05  9.412784e-05 -1.216173e-04  1.922159e-04</span></span></code></pre>
<p>Internally, <strong>errors</strong> provides S3 methods for the
generics belonging to the groups <code>Math</code> and <code>Ops</code>,
which propagate the uncertainty and the covariance using Equations (2)
and (3) respectively.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="co"># previous computation without correlations</span></span></code></pre></div>
<pre><code><span><span class="co">## Errors: 0.021229025 0.011569056 0.007427156 0.005602416 0.004485713</span></span>
<span><span class="co">## [1] 0.9638614 1.0198565 0.9935139 1.0012085 1.0023766</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">z_correl</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">/</span> <span class="va">y</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Errors: 0.024606702 0.009802843 0.005857672 0.006829703 0.002161687</span></span>
<span><span class="co">## [1] 0.9638614 1.0198565 0.9935139 1.0012085 1.0023766</span></span></code></pre>
<p>Other many S3 methods are also provided, such as generics belonging
to the <code>Summary</code> group, subsetting operators (<code>[</code>,
<code>[&lt;-</code>, <code>[[</code>, <code>[[&lt;-</code>),
concatenation (<code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code>), differentiation (<code>diff</code>),
row and column binding (<code>rbind</code>, <code>cbind</code>),
coercion to list, data frame and matrix, and more. Such methods mutate
the <code>errors</code> object, and thus return a new one with no
correlations associated. There are also <em>setters</em> defined as an
alternative to the assignment methods (<code>set_*()</code> instead of
<code>errors&lt;-</code>, <code>correl&lt;-</code> and
<code>covar&lt;-</code>), primarily intended for their use in
conjunction with the pipe operator (<code>%&gt;%</code>) from the
<strong>magrittr</strong> <span class="citation">(<a href="#ref-CRAN:magrittr">Bache and Wickham 2014</a>)</span>
package.</p>
<p>Additionally, other useful summaries are provided, namely, the mean,
the weighted mean and the median. The uncertainty of any measurement of
central tendency cannot be smaller than the uncertainty of the
individual measurements. Therefore, the uncertainty assigned to the mean
is computed as the maximum between the standard deviation of the mean
and the mean of the individual uncertainties (weighted, in the case of
the weighted mean). As for the median, its uncertainty is computed as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mrow><mi>π</mi><mi>/</mi><mn>2</mn></mrow></msqrt><mo>≈</mo><mn>1.253</mn></mrow><annotation encoding="application/x-tex">\sqrt{\pi/2}\approx1.253</annotation></semantics></math>
times the standard deviation of the mean, where this constant comes from
the asymptotic variance formula <span class="citation">(<a href="#ref-Hampel:2011:Robust">Hampel et al. 2011</a>)</span>.</p>
<p>It is worth noting that both values and uncertainties are stored with
all the digits. However, when a single measurement or a column of
measurements in a data frame are printed, there are S3 methods for
<code><a href="https://rdrr.io/r/base/format.html" class="external-link">format()</a></code> and <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> defined to properly
format the output and display a single significant digit for the
uncertainty. This default representation can be overridden using the
<code>digits</code> option, and it is globally controlled with the
option <code>errors.digits</code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the elementary charge</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/errors.html">set_errors</a></span><span class="op">(</span><span class="fl">1.6021766208e-19</span>, <span class="fl">0.0000000098e-19</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">e</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 1.6021766208(98)e-19</span></span></code></pre>
<p>The <em>parenthesis</em> notation, in which <em>the number in
parentheses is the uncertainty referred to the corresponding last digits
of the quantity value</em> (scheme 2 from the GUM, widely used in
physics due to its compactness), is used by default, but this can be
overridden through the appropriate option in order to use the
<em>plus-minus</em> notation instead.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>errors.notation <span class="op">=</span> <span class="st">"plus-minus"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">e</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## (1.6021766208 ± 0.0000000098)e-19</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>errors.notation <span class="op">=</span> <span class="st">"parenthesis"</span><span class="op">)</span></span></code></pre></div>
<p>Finally, <strong>errors</strong> also facilitates plotting of error
bars. In the following, we first assign a 2% of uncertainty to all the
numeric variables in the <code>iris</code> data set and then we plot it
using base graphics and <strong>ggplot2</strong> <span class="citation">(<a href="#ref-CRAN:ggplot2">Wickham and Chang
2016</a>; <a href="#ref-Wickham:2009:ggplot2">Wickham 2009</a>)</span>.
The result is shown in Figure 2.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris.e</span> <span class="op">&lt;-</span> <span class="va">iris</span></span>
<span><span class="va">iris.e</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">iris.e</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/errors.html">set_errors</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">x</span><span class="op">*</span><span class="fl">0.02</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">iris.e</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span><span class="co">## 1       5.1(1)     3.50(7)      1.40(3)    0.200(4)  setosa</span></span>
<span><span class="co">## 2       4.9(1)     3.00(6)      1.40(3)    0.200(4)  setosa</span></span>
<span><span class="co">## 3      4.70(9)     3.20(6)      1.30(3)    0.200(4)  setosa</span></span>
<span><span class="co">## 4      4.60(9)     3.10(6)      1.50(3)    0.200(4)  setosa</span></span>
<span><span class="co">## 5       5.0(1)     3.60(7)      1.40(3)    0.200(4)  setosa</span></span>
<span><span class="co">## 6       5.4(1)     3.90(8)      1.70(3)    0.400(8)  setosa</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">Sepal.Length</span>, <span class="va">iris.e</span>, col<span class="op">=</span><span class="va">Species</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="fl">6.2</span>, <span class="fl">4.4</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">iris.e</span><span class="op">[[</span><span class="st">"Species"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">iris.e</span><span class="op">[[</span><span class="st">"Species"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, pch<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris.e</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Sepal.Length</span>, <span class="va">Sepal.Width</span>, color<span class="op">=</span><span class="va">Species</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/geom_errors.html">geom_errors</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="rjournal_files/figure-html/plot-1.png" alt="Figure 2: Base plot with error bars (left) and ggplot2's version (right)." width="100%"><p class="caption">
Figure 2: Base plot with error bars (left) and ggplot2’s version
(right).
</p>
</div>
<p>In base graphics, the error bars are automatically plotted when an
object of class <code>errors</code> is passed. Additionally, we provide
the convenience functions <code>errors_min(x)</code> and
<code>errors_max(x)</code> for obtaining the boundaries of the interval
in <strong>ggplot2</strong> and other plotting packages, instead of
writing <code>x - errors(x)</code> and <code>x + errors(x)</code>
respectively.</p>
</div>
<div class="section level3">
<h3 id="example-simultaneous-resistance-and-reactance-measurement">Example: Simultaneous resistance and reactance measurement<a class="anchor" aria-label="anchor" href="#example-simultaneous-resistance-and-reactance-measurement"></a>
</h3>
<p>From Annex H.2 of the GUM <span class="citation">(<a href="#ref-GUM:2008">BIPM et al. 2008</a>)</span>:</p>
<blockquote>
<p>The resistance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
and the reactance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
of a circuit element are determined by measuring the amplitude
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>V</mi><annotation encoding="application/x-tex">V</annotation></semantics></math>
of a sinusoidally-alternating potential difference across its terminals,
the amplitude
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>I</mi><annotation encoding="application/x-tex">I</annotation></semantics></math>
of the alternating current passing through it, and the phase-shift angle
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>
of the alternating potential difference relative to the alternating
current.</p>
</blockquote>
<p>The measurands (resistance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>,
reactance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
and impedance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Z</mi><annotation encoding="application/x-tex">Z</annotation></semantics></math>)
are related to the input quantities
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>V</mi><annotation encoding="application/x-tex">V</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>I</mi><annotation encoding="application/x-tex">I</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>h</mi><mi>i</mi></mrow><annotation encoding="application/x-tex">phi</annotation></semantics></math>)
by the Ohm’s law:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><mfrac><mi>V</mi><mi>I</mi></mfrac><mo>cos</mo><mi>ϕ</mi><mo>;</mo><mspace width="2.0em"></mspace><mi>X</mi><mo>=</mo><mfrac><mi>V</mi><mi>I</mi></mfrac><mo>sin</mo><mi>ϕ</mi><mo>;</mo><mspace width="2.0em"></mspace><mi>Z</mi><mo>=</mo><mfrac><mi>V</mi><mi>I</mi></mfrac></mrow><annotation encoding="application/x-tex">\begin{equation*}
  R = \frac{V}{I}\cos\phi; \qquad X = \frac{V}{I}\sin\phi; \qquad Z = \frac{V}{I}
  \tag{4}
\end{equation*}</annotation></semantics></math></p>
<p>Five simultaneous observations for each input variable are provided
(Table H.2 of the GUM), which are included in <strong>errors</strong> as
dataset <code>GUM.H.2</code>. First, we need to obtain the mean input
values and set the correlations from the measurements. Then, we compute
the measurands and examine the correlations between them. The results
agree with those reported in the GUM:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">V</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="../reference/errors.html">set_errors</a></span><span class="op">(</span><span class="va">GUM.H.2</span><span class="op">$</span><span class="va">V</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">I</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="../reference/errors.html">set_errors</a></span><span class="op">(</span><span class="va">GUM.H.2</span><span class="op">$</span><span class="va">I</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">phi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="../reference/errors.html">set_errors</a></span><span class="op">(</span><span class="va">GUM.H.2</span><span class="op">$</span><span class="va">phi</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/correl.html">correl</a></span><span class="op">(</span><span class="va">V</span>, <span class="va">I</span><span class="op">)</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">GUM.H.2</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">V</span>, <span class="va">I</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/correl.html">correl</a></span><span class="op">(</span><span class="va">V</span>, <span class="va">phi</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">GUM.H.2</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">V</span>, <span class="va">phi</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/correl.html">correl</a></span><span class="op">(</span><span class="va">I</span>, <span class="va">phi</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">GUM.H.2</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">I</span>, <span class="va">phi</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">R</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">V</span> <span class="op">/</span> <span class="va">I</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">phi</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span>, notation <span class="op">=</span> <span class="st">"plus-minus"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 127.732 ± 0.071</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">X</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">V</span> <span class="op">/</span> <span class="va">I</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">phi</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">3</span>, notation <span class="op">=</span> <span class="st">"plus-minus"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 219.847 ± 0.296</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">V</span> <span class="op">/</span> <span class="va">I</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">3</span>, notation <span class="op">=</span> <span class="st">"plus-minus"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 254.260 ± 0.236</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/correl.html">correl</a></span><span class="op">(</span><span class="va">R</span>, <span class="va">X</span><span class="op">)</span>; <span class="fu"><a href="../reference/correl.html">correl</a></span><span class="op">(</span><span class="va">R</span>, <span class="va">Z</span><span class="op">)</span>; <span class="fu"><a href="../reference/correl.html">correl</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Z</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -0.5884298</span></span></code></pre>
<pre><code><span><span class="co">## [1] -0.4852592</span></span></code></pre>
<pre><code><span><span class="co">## [1] 0.9925116</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="example-calibration-of-a-thermometer">Example: Calibration of a thermometer<a class="anchor" aria-label="anchor" href="#example-calibration-of-a-thermometer"></a>
</h3>
<p>From Annex H.3 of the GUM <span class="citation">(<a href="#ref-GUM:2008">BIPM et al. 2008</a>)</span>:</p>
<blockquote>
<p>A thermometer is calibrated by comparing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>11</mn></mrow><annotation encoding="application/x-tex">n=11</annotation></semantics></math>
temperature readings
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>k</mi></msub><annotation encoding="application/x-tex">t_k</annotation></semantics></math>
of the thermometer […] with corresponding known reference temperatures
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mrow><mi>R</mi><mo>,</mo><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">t_{R,k}</annotation></semantics></math>
in the temperature range 21
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mo>∘</mo></msup><annotation encoding="application/x-tex">^\circ</annotation></semantics></math>C
to 27
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mo>∘</mo></msup><annotation encoding="application/x-tex">^\circ</annotation></semantics></math>C
to obtain the corrections
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>k</mi></msub><mo>=</mo><msub><mi>t</mi><mrow><mi>R</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>−</mo><msub><mi>t</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">b_k=t_{R,k}-t_k</annotation></semantics></math>
to the readings.</p>
</blockquote>
<p>Measured temperatures and corrections (Table H.6 of the GUM), which
are included in <strong>errors</strong> as dataset <code>GUM.H.3</code>,
are related by a linear calibration curve:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>y</mi><mn>1</mn></msub><mo>+</mo><msub><mi>y</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>−</mo><msub><mi>t</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{equation*}
  b(t) = y_1 + y_2 (t - t_0) \tag{5}
\end{equation*}</annotation></semantics></math></p>
<p>In the following, we first fit the linear model for a reference
temperature
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mn>0</mn></msub><mo>=</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">t_0=20</annotation></semantics></math><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mo>∘</mo></msup><annotation encoding="application/x-tex">^\circ</annotation></semantics></math>C.
Then, we extract the coefficients, and assign the uncertainty and
correlation between them. Finally, we compute the predicted correction
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>30</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">b(30)</annotation></semantics></math>,
which agrees with the value reported in the GUM:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">bk</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">tk</span> <span class="op">-</span> <span class="fl">20</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">GUM.H.3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/errors.html">set_errors</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/errors.html">set_errors</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/correl.html">covar</a></span><span class="op">(</span><span class="va">y1</span>, <span class="va">y2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">b.30</span> <span class="op">&lt;-</span> <span class="va">y1</span> <span class="op">+</span> <span class="va">y2</span> <span class="op">*</span> <span class="fu"><a href="../reference/errors.html">set_errors</a></span><span class="op">(</span><span class="fl">30</span> <span class="op">-</span> <span class="fl">20</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span>, notation <span class="op">=</span> <span class="st">"plus-minus"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## -0.1494 ± 0.0041</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="discussion">Discussion<a class="anchor" aria-label="anchor" href="#discussion"></a>
</h2>
<p>The <strong>errors</strong> package provides the means for defining
numeric vectors, matrices and arrays with errors in R, as well as to
operate with them in a transparent way. Propagation of uncertainty
implements the commonly used first-order TSM formula from Equation (1).
This method has been pre-computed and expanded for each operation in the
S3 groups <code>Math</code> and <code>Ops</code>, instead of
differentiating symbolic expressions on demand or using functions from
other packages for this task. The advantages of this approach are
twofold. On the one hand, it is faster, as it does not involve
simulation nor symbolic computation, and very lightweight in terms of
package dependencies.</p>
<p>Another advantage of <strong>errors</strong> is the built-in
consistent and formally sound representation of measurements with
errors, rounding the uncertainty to one significant digit by default and
supporting two widely used notations: <em>parenthesis</em> (e.g.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5.00</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">5.00(1)</annotation></semantics></math>)
and <em>plus-minus</em> (e.g.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5.00</mn><mo>±</mo><mn>0.01</mn></mrow><annotation encoding="application/x-tex">5.00 \pm 0.01</annotation></semantics></math>).
These notations are applied for single numbers and data frames, as well
as <code>tbl_df</code> data frames from the <strong>tibble</strong>
<span class="citation">(<a href="#ref-CRAN:tibble">Wickham, Francois,
and Müller 2017</a>)</span> package.</p>
<p>Full support is provided for both <code>data.frame</code> and
<code>tbl_df</code>, as well as matrices and arrays. However, some
operations on those data structures may drop uncertainties (i.e., object
class and attributes). More specifically, there are six common <em>data
wrangling</em> operations: row subsetting, row ordering, column
transformation, row aggregation, column joining and (un)pivoting. Table
1 shows the correspondence between these operations and R base
functions, as well as the compatibility with
<strong>errors</strong>.</p>
<table class="table">
<caption>Table 1: Compatibility of errors and R base data wrangling
functions.</caption>
<colgroup>
<col width="30%">
<col width="38%">
<col width="30%">
</colgroup>
<thead><tr class="header">
<th align="left">Operation</th>
<th align="left">R base function(s)</th>
<th align="left">Compatibility</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Row subsetting</td>
<td align="left">
<code>[</code>, <code>[[</code>,
<code>subset</code>
</td>
<td align="left">Full</td>
</tr>
<tr class="even">
<td align="left">Row ordering</td>
<td align="left">
<code>order</code> + <code>[</code>
</td>
<td align="left">Full</td>
</tr>
<tr class="odd">
<td align="left">Column transformation</td>
<td align="left">
<code>transform</code>, <code>within</code>
</td>
<td align="left">Full</td>
</tr>
<tr class="even">
<td align="left">Row aggregation</td>
<td align="left">
<code>tapply</code>, <code>by</code>,
<code>aggregate</code>
</td>
<td align="left">with <code>simplify=FALSE</code>
</td>
</tr>
<tr class="odd">
<td align="left">Column joining</td>
<td align="left"><code>merge</code></td>
<td align="left">Full</td>
</tr>
<tr class="even">
<td align="left">(Un)Pivoting</td>
<td align="left"><code>reshape</code></td>
<td align="left">Full</td>
</tr>
</tbody>
</table>
<p>Overall, <strong>errors</strong> is fully compatible with data
wrangling operations embed in R base, and this is because those
functions are mainly based on the subsetting generics, for which
<strong>errors</strong> provides the corresponding S3 methods.
Nonetheless, special attention must be paid to aggregations, which store
partial results in lists that are finally simplified. Such
simplification is made with <code>unlist</code>, which drops all the
input attributes, including custom classes. However, all these
aggregation functions provide the argument <code>simplify</code>
(sometimes <code>SIMPLIFY</code>), which if set to <code>FALSE</code>,
prevents this destructive simplification, and lists are returned. Such
lists can be simplified <em>non-destructively</em> by calling
<code>do.call(c, ...)</code>.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unlist</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">is.list</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">c</span>, <span class="va">x</span><span class="op">)</span> <span class="kw">else</span> <span class="va">x</span></span>
<span><span class="va">iris.e.agg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">Species</span>, data <span class="op">=</span> <span class="va">iris.e</span>, <span class="va">mean</span>, simplify<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">iris.e.agg</span>, <span class="va">unlist</span><span class="op">)</span>, col.names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">iris.e.agg</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      Species Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span><span class="co">## 1     setosa       5.0(1)     3.43(7)      1.46(3)     0.25(1)</span></span>
<span><span class="co">## 2 versicolor       5.9(1)     2.77(6)      4.26(9)     1.33(3)</span></span>
<span><span class="co">## 3  virginica       6.6(1)     2.97(6)       5.6(1)     2.03(4)</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="summary-and-future-work">Summary and future work<a class="anchor" aria-label="anchor" href="#summary-and-future-work"></a>
</h2>
<p>We have introduced <strong>errors</strong>, a lightweight R package
for managing numeric data with associated standard uncertainties. The
new class <code>errors</code> provides numeric operations with automated
propagation of uncertainty through a first-order TSM, and a formally
sound representation of measurements with errors. Using this package
makes the process of computing indirect measurements easier and less
error-prone.</p>
<p>Future work includes importing and exporting data with uncertainties
and providing the user with an interface for plugging uncertainty
propagation methods from other packages. Finally,
<strong>errors</strong> enables ongoing developments for integrating
<strong>units</strong> and uncertainty handling into a complete solution
for quantity calculus. Having a unified workflow for managing
measurements with units and errors would be an interesting addition to
the R ecosystem with very few precedents in other programming
languages.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Arras:1998" class="csl-entry">
Arras, K. O. 1998. <span>“An Introduction to Error Propagation:
Derivation, Meaning and Examples of Cy = Fx Cx Fx’,”</span> September.
</div>
<div id="ref-CRAN:magrittr" class="csl-entry">
Bache, Stefan Milton, and Hadley Wickham. 2014. <em>Magrittr: A
Forward-Pipe Operator for r</em>. <a href="https://CRAN.R-project.org/package=magrittr" class="external-link">https://CRAN.R-project.org/package=magrittr</a>.
</div>
<div id="ref-GUM:2008" class="csl-entry">
BIPM, IEC, IFCC, ILAC, IUPAC, IUPAP, ISO, and OIML. 2008. <span>“<span class="nocase">Evaluation of Measurement Data – Guide to the Expression
of Uncertainty in Measurement, 1st edn. JCGM 100:2008</span>.”</span>
<em>Joint Committee for Guides in Metrology</em>. <a href="https://www.bipm.org/en/committees/jc/jcgm/publications" class="external-link">https://www.bipm.org/en/committees/jc/jcgm/publications</a>.
</div>
<div id="ref-VIM:2012" class="csl-entry">
———. 2012. <span>“<span class="nocase">The International Vocabulary of
Metrology – Basic and General Concepts and Associated Terms (VIM), 3rd
edn. JCGM 200:2012</span>.”</span> <em>Joint Committee for Guides in
Metrology</em>. <a href="https://www.bipm.org/en/committees/jc/jcgm/publications" class="external-link">https://www.bipm.org/en/committees/jc/jcgm/publications</a>.
</div>
<div id="ref-CRAN:metRology" class="csl-entry">
Ellison, Stephen L R. 2017. <em>metRology: Support for Metrological
Applications</em>. <a href="https://CRAN.R-project.org/package=metRology" class="external-link">https://CRAN.R-project.org/package=metRology</a>.
</div>
<div id="ref-Flatter:2018" class="csl-entry">
Flater, David. 2018. <span>“<span class="nocase">Architecture for
software-assisted quantity calculus</span>.”</span> <em>Computer
Standards &amp; Interfaces</em> 56: 144–47. <a href="https://doi.org/10.1016/j.csi.2017.10.002" class="external-link">https://doi.org/10.1016/j.csi.2017.10.002</a>.
</div>
<div id="ref-Fox:2011:car" class="csl-entry">
Fox, John, and Sanford Weisberg. 2011. <em>An <span>R</span> Companion
to Applied Regression</em>. Second. SAGE Publications.
</div>
<div id="ref-CRAN:car" class="csl-entry">
———. 2016. <em>Car: Companion to Applied Regression</em>. <a href="https://CRAN.R-project.org/package=car" class="external-link">https://CRAN.R-project.org/package=car</a>.
</div>
<div id="ref-Hampel:2011:Robust" class="csl-entry">
Hampel, F. R., E. M. Ronchetti, P. J. Rousseeuw, and W. A. Stahel. 2011.
<em>Robust Statistics: The Approach Based on Influence Functions</em>.
Wiley Series in Probability and Statistics. Wiley.
</div>
<div id="ref-CRAN:msm" class="csl-entry">
Jackson, Christopher. 2016. <em>Msm: Multi-State Markov and Hidden
Markov Models in Continuous Time</em>. <a href="https://CRAN.R-project.org/package=msm" class="external-link">https://CRAN.R-project.org/package=msm</a>.
</div>
<div id="ref-Jackson:2011:msm" class="csl-entry">
Jackson, Christopher H. 2011. <span>“Multi-State Models for Panel Data:
The <span class="nocase">msm</span> Package for <span>R</span>.”</span>
<em>Journal of Statistical Software</em> 38 (8): 1–29. <a href="https://doi.org/10.18637/jss.v038.i08" class="external-link">https://doi.org/10.18637/jss.v038.i08</a>.
</div>
<div id="ref-CRAN:distr" class="csl-entry">
Kohl, Matthias. 2017. <em>Distr: Object Oriented Implementation of
Distributions</em>. <a href="https://CRAN.R-project.org/package=distr" class="external-link">https://CRAN.R-project.org/package=distr</a>.
</div>
<div id="ref-CRAN:units" class="csl-entry">
Pebesma, Edzer, and Thomas Mailund. 2017. <em>Units: Measurement Units
for r Vectors</em>. <a href="https://CRAN.R-project.org/package=units" class="external-link">https://CRAN.R-project.org/package=units</a>.
</div>
<div id="ref-Pebesma:2016:units" class="csl-entry">
Pebesma, Edzer, Thomas Mailund, and James Hiebert. 2016. <span>“<span class="nocase">Measurement Units in R</span>.”</span> <em><span>The R
Journal</span></em> 8 (2): 486–94. <a href="https://journal.r-project.org/archive/2016/RJ-2016-061/index.html" class="external-link">https://journal.r-project.org/archive/2016/RJ-2016-061/index.html</a>.
</div>
<div id="ref-Ruckdeschel:2006:distr" class="csl-entry">
Ruckdeschel, P., M. Kohl, T. Stabla, and F. Camphausen. 2006. <span>“S4
Classes for Distributions.”</span> <em>R News</em> 6 (2): 2–6.
</div>
<div id="ref-CRAN:spup" class="csl-entry">
Sawicka, Kasia, and Gerard Heuvelink. 2017. <em>Spup: Uncertainty
Propagation Analysis</em>. <a href="https://CRAN.R-project.org/package=spup" class="external-link">https://CRAN.R-project.org/package=spup</a>.
</div>
<div id="ref-CRAN:propagate" class="csl-entry">
Spiess, Andrej-Nikolai. 2014. <em>Propagate: Propagation of
Uncertainty</em>. <a href="https://CRAN.R-project.org/package=propagate" class="external-link">https://CRAN.R-project.org/package=propagate</a>.
</div>
<div id="ref-CRAN:errors" class="csl-entry">
Ucar, Iñaki. 2018. <em>Errors: Uncertainty Propagation for r
Vectors</em>. <a href="https://CRAN.R-project.org/package=errors" class="external-link">https://CRAN.R-project.org/package=errors</a>.
</div>
<div id="ref-Wickham:2009:ggplot2" class="csl-entry">
Wickham, Hadley. 2009. <em>Ggplot2: Elegant Graphics for Data
Analysis</em>. Springer-Verlag New York.
</div>
<div id="ref-CRAN:ggplot2" class="csl-entry">
Wickham, Hadley, and Winston Chang. 2016. <em>Ggplot2: Create Elegant
Data Visualisations Using the Grammar of Graphics</em>. <a href="https://CRAN.R-project.org/package=ggplot2" class="external-link">https://CRAN.R-project.org/package=ggplot2</a>.
</div>
<div id="ref-CRAN:tibble" class="csl-entry">
Wickham, Hadley, Romain Francois, and Kirill Müller. 2017. <em>Tibble:
Simple Data Frames</em>. <a href="https://CRAN.R-project.org/package=tibble" class="external-link">https://CRAN.R-project.org/package=tibble</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Iñaki Ucar.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
