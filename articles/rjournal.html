<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Measurement Errors in R • errors</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Measurement Errors in R">
<meta property="og:description" content="errors">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">errors</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/rjournal.html">Measurement Errors in R</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/r-quantities/errors/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Measurement Errors in R</h1>
                        <h4 data-toc-skip class="author">Iñaki Ucar,
Edzer Pebesma, Arturo Azcorra</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/r-quantities/errors/blob/HEAD/vignettes/rjournal.Rmd" class="external-link"><code>vignettes/rjournal.Rmd</code></a></small>
      <div class="hidden name"><code>rjournal.Rmd</code></div>

    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>This paper presents an R package to handle and represent
      measurements with errors in a very simple way. We briefly
      introduce the main concepts of metrology and propagation of
      uncertainty, and discuss related R packages. Building upon this,
      we introduce the package, which provides a class for associating
      uncertainty metadata, automated propagation and reporting. Working
      with enables transparent, lightweight, less error-prone handling
      and convenient representation of measurements with errors.
      Finally, we discuss the advantages, limitations and future work of
      computing with errors.</p>
    </div>
    
<p>This manuscript corresponds to <code>errors</code> version 0.4.0 and
was typeset on December 04, 2022. For citations, please use the version
published in the R Journal (see <code>citation("errors")</code>).</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The International Vocabulary of Metrology (VIM) defines a as “a
property of a phenomenon, body, or substance, where the property has a
magnitude that can be expressed as a number and a reference”, where most
typically the number is a , attributed to a and experimentally obtained
via some measurement procedure, and the reference is a .</p>
<p>Additionally, any quantity value must accommodate some indication
about the quality of the measurement, a quantifiable attribute known as
. The Guide to the Expression of Uncertainty in Measurement (GUM)
defines as “a parameter, associated with the result of a measurement,
that characterises the dispersion of the values that could reasonably be
attributed to the measurand” . Uncertainty can be mainly classified into
, which is the result of a direct measurement (e.g., electrical voltage
measured with a voltmeter, or current measured with a amperemeter), and
, which is the result of an indirect measurement (i.e., the standard
uncertainty when the result is derived from a number of other quantities
by the means of some mathematical relationship; e.g., electrical power
as a product of voltage and current). Therefore, provided a set of
quantities with known uncertainties, the process of obtaining the
uncertainty of a derived measurement is called .</p>
<p>Traditionally, computational systems have treated these three
components (quantity values, measurement units and uncertainty)
separately. Data consisted of bare numbers, and mathematical operations
applied to them solely. Units were just metadata, and uncertainty
propagation was an unpleasant task requiring additional effort and
complex operations. Nowadays though, many software libraries have
formalised as method of including units within the scope of mathematical
operations, thus preserving dimensional correctness and protecting us
from computing nonsensical combinations of quantities. However, these
libraries rarely integrate uncertainty handling and propagation .</p>
<p>Within the R environment, the package defines a class for associating
unit metadata to numeric vectors, which enables transparent quantity
derivation, simplification and conversion. This approach is a very
comfortable way of managing units with the added advantage of
eliminating an entire class of potential programming mistakes.
Unfortunately, neither nor any other package address the integration of
uncertainties into quantity calculus.</p>
<p>This article presents , a package that defines a framework for
associating uncertainty metadata to R vectors, matrices and arrays, thus
providing transparent, lightweight and automated propagation of
uncertainty. This implementation also enables ongoing developments for
integrating units and uncertainty handling into a complete solution.</p>
</div>
<div class="section level2">
<h2 id="propagation-of-uncertainty">Propagation of uncertainty<a class="anchor" aria-label="anchor" href="#propagation-of-uncertainty"></a>
</h2>
<p>There are two main methods for propagation of uncertainty: the (TSM)
and the (MCM). The TSM, also called the , is based on a Taylor expansion
of the mathematical expression that produces the output variables. As
for the MCM, it can deal with generalised input distributions and
propagates the uncertainty by Monte Carlo simulation.</p>
<div class="section level3">
<h3 id="taylor-series-method">Taylor series method<a class="anchor" aria-label="anchor" href="#taylor-series-method"></a>
</h3>
<p>The TSM is a flexible and simple method of propagation of uncertainty
that offers a good degree of approximation in most cases. In the
following, we will provide a brief description. A full derivation,
discussion and examples can be found in .</p>
<p>Mathematically, an indirect measurement is obtained as a function of
<span class="math inline">\(n\)</span> direct or indirect measurements,
<span class="math inline">\(Y = f(X_1, ..., X_n)\)</span>, where the
distribution of <span class="math inline">\(X_n\)</span> is unknown
<em>a priori</em>. Usually, the sources of random variability are many,
independent and probably unknown as well. Thus, the central limit
theorem establishes that an addition of a sufficiently large number of
random variables tends to a normal distribution. As a result, the states
that <span class="math inline">\(X_n\)</span> are normally
distributed.</p>
<p>The presumes linearity, i.e., that <span class="math inline">\(f\)</span> can be approximated by a first-order
Taylor series expansion around <span class="math inline">\(\mu_{X_n}\)</span> (see Figure <span class="math inline">\(\ref{propagation}\)</span>). Then, given a set of
<span class="math inline">\(n\)</span> input variables <span class="math inline">\(X\)</span> and a set of <span class="math inline">\(m\)</span> output variables <span class="math inline">\(Y\)</span>, the first-order establishes that</p>
<p><span class="math display">\[\begin{equation}\Sigma_Y = J_X \Sigma_X
J_X^T\label{eq:prop-law}\end{equation}\]</span></p>
<p>where <span class="math inline">\(\Sigma\)</span> is the covariance
matrix and <span class="math inline">\(J\)</span> is the Jacobian
operator.</p>
<div class="figure" style="text-align: center">
<embed src="includes/rjournal-propagation.pdf" title="Illustration of linearity in an interval $\pm$ one standard deviation around the mean.\label{propagation}" width="50%" type="application/pdf"></embed><p class="caption">
Illustration of linearity in an interval <span class="math inline">\(\pm\)</span> one standard deviation around the
mean.
</p>
</div>
<p>In practice, as recommended in the GUM , this first-order
approximation is good even if <span class="math inline">\(f\)</span> is
non-linear, provided that the non-linearity is negligible compared to
the magnitude of the uncertainty, i.e., <span class="math inline">\(\E[f(X)]\approx f(\E[X])\)</span>. Also, this
weaker condition is distribution-free: no assumptions are needed on the
probability density functions (PDF) of <span class="math inline">\(X_n\)</span>, although they must be reasonably
symmetric.</p>
<p>If we consider Equation <span class="math inline">\(\eqref{eq:prop-law}\)</span> for pairwise
computations, i.e., <span class="math inline">\(Y = f(X_1,
X_2)\)</span>, we can write the propagation of the uncertainty <span class="math inline">\(\sigma_Y\)</span> as follows:</p>
<p><span class="math display">\[\begin{equation}\label{eq:prop-var}
  \sigma_Y^2 = \left(\frac{\partial^2 f}{\partial X_1^2}\right)^2
\sigma_{X_1}^2 +
               \left(\frac{\partial^2 f}{\partial X_2^2}\right)^2
\sigma_{X_2}^2 +
               2 \frac{\partial f \partial f}{\partial X_1 \partial X_2}
\sigma_{X_1 X_2}
\end{equation}\]</span></p>
<p>The cross-covariances for the output <span class="math inline">\(Y\)</span> and any other variable <span class="math inline">\(Z\)</span> can be simplified as follows:</p>
<p><span class="math display">\[\begin{equation}\label{eq:prop-covar}
  \sigma_{Y Z} = \frac{\partial f}{\partial X_1} \sigma_{X_1 Z} +
                 \frac{\partial f}{\partial X_2} \sigma_{X_2 Z}
\end{equation}\]</span></p>
<p>where, notably, if <span class="math inline">\(Z=X_i\)</span>, one of
the covariances above results in <span class="math inline">\(\sigma_{X_i}^2\)</span>. Finally, and for the sake
of completeness, the correlation coefficient can be obtained as <span class="math inline">\(r_{Y Z} = \sigma_{Y Z} /
(\sigma_{Y}\sigma_{Z})\)</span>.</p>
</div>
<div class="section level3">
<h3 id="monte-carlo-method">Monte Carlo method<a class="anchor" aria-label="anchor" href="#monte-carlo-method"></a>
</h3>
<p>The MCM is based on the same principles underlying the TSM. It is
based on the propagation of the PDFs of the input variables <span class="math inline">\(X_n\)</span> by performing random sampling and
evaluating them under the model considered. Thus, this method is not
constrained by the TSM assumptions, and explicitly determines a PDF for
the output quantity <span class="math inline">\(Y\)</span>, which makes
it a more general approach that applies to a broader set of problems.
For further details on this method, as well as a comparison with the TSM
and some discussion on the applicability of both methods, the reader may
refer to the Supplement 1 of the GUM .</p>
</div>
</div>
<div class="section level2">
<h2 id="reporting-uncertainty">Reporting uncertainty<a class="anchor" aria-label="anchor" href="#reporting-uncertainty"></a>
</h2>
<p>The GUM defines four ways of reporting standard uncertainty and
combined standard uncertainty. For instance, if the reported quantity is
assumed to be a mass <span class="math inline">\(m_S\)</span> of nominal
value 100 g:</p>
<blockquote>
<ol style="list-style-type: decimal">
<li>
<span class="math inline">\(m_S = 100.02147\)</span> g with (a
combined standard uncertainty) <span class="math inline">\(u_c\)</span>
= 0.35 mg.</li>
<li>
<span class="math inline">\(m_S = 100.02147(35)\)</span> g, where
the number in parentheses is the numerical value of (the combined
standard uncertainty) <span class="math inline">\(u_c\)</span> referred
to the corresponding last digits of the quoted result.</li>
<li>
<span class="math inline">\(m_S = 100.02147(0.00035)\)</span> g,
where the number in parentheses is the numerical value of (the combined
standard uncertainty) <span class="math inline">\(u_c\)</span> expressed
in the unit of the quoted result.</li>
<li>
<span class="math inline">\(m_S = (100.02147 \pm 0.00035)\)</span>
g, where the number following the symbol <span class="math inline">\(\pm\)</span> is the numerical value of (the
combined standard uncertainty) <span class="math inline">\(u_c\)</span>
and not a confidence interval.</li>
</ol>
</blockquote>
<p>Schemes (2, 3) and (4) would be referred to as notation and notation
respectively throughout this document. Although (4) is a very extended
notation, the GUM explicitly discourages its use to prevent confusion
with confidence intervals.</p>
</div>
<div class="section level2">
<h2 id="related-work">Related work<a class="anchor" aria-label="anchor" href="#related-work"></a>
</h2>
<p>Several R packages are devoted to or provide methods for propagation
of uncertainties. The and packages provide the functions and
respectively. Both of them implement a first-order TSM with a similar
syntax, requiring a formula, a vector of values and a covariance matrix,
thus being able to deal with dependency across variables.</p>
<p>The and packages stand out as very comprehensive sets of tools
specifically focused on this topic, including both TSM and MCM. The
package implements TSM using algebraic or numeric differentiation, with
support for correlation. It also provides a function for assessing the
statistical performance of GUM uncertainty (TSM) using attained coverage
probability. The package implements TSM up to second order. It provides
a unified interface for both TSM and MCM through the function, which
requires an expression and a data frame or matrix as input.
Unfortunately, as in the case of and , these packages are limited to
work only with expressions, which does not solve the issue of requiring
a separate workflow to deal with uncertainties.</p>
<p>The package focuses on uncertainty analysis in spatial environmental
modelling, where the spatial cross-correlation between variables becomes
important. The uncertainty is described with probability distributions
and propagated using MCM.</p>
<p>Finally, the package takes this idea one step further by providing an
S4-based object-oriented implementation of probability distributions,
with which one can operate arithmetically or apply mathematical
functions. It implements all kinds of probability distributions and has
more methods for computing the distribution of derived quantities. Also,
is the base of a whole family of packages, such as , , , , and .</p>
<p>All these packages provide excellent tools for uncertainty analysis
and propagation. However, none of them addresses the issue of an
integrated workflow, as does for unit metadata by assigning units
directly to R vectors, matrices and arrays. As a result, units can be
added to any existing R computation in a very straightforward way. On
the other hand, existing tools for uncertainty propagation require
building specific expressions or data structures, and then some more
work to extract the results out and to report them properly, with an
appropriate number of significant digits.</p>
</div>
<div class="section level2">
<h2 id="automated-uncertainty-handling-in-r-the-package">Automated uncertainty handling in R: the package<a class="anchor" aria-label="anchor" href="#automated-uncertainty-handling-in-r-the-package"></a>
</h2>
<p>The package aims to provide easy and lightweight handling of
measurement with errors, including uncertainty propagation using the
first-order TSM presented in the previous section and a formally sound
representation.</p>
<div class="section level3">
<h3 id="package-description-and-usage">Package description and usage<a class="anchor" aria-label="anchor" href="#package-description-and-usage"></a>
</h3>
<p>Standard uncertainties, can be assigned to numeric vectors, matrices
and arrays, and then all the mathematical and arithmetic operations are
transparently applied to both the values and the associated
uncertainties:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-quantities/errors" class="external-link">errors</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">5</span>, sd <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">5</span>, sd <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/errors.html">errors</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0.01</span></span>
<span><span class="fu"><a href="../reference/errors.html">errors</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0.02</span></span>
<span><span class="va">x</span>; <span class="va">y</span></span></code></pre></div>
<pre><code><span><span class="co">## Errors: 0.01 0.01 0.01 0.01 0.01</span></span>
<span><span class="co">## [1] 0.9931391 1.9835562 3.0102445 4.0128646 4.9994045</span></span></code></pre>
<pre><code><span><span class="co">## Errors: 0.02 0.02 0.02 0.02 0.02</span></span>
<span><span class="co">## [1] 0.9958207 2.0043566 2.9882167 3.9729007 5.0057018</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">z</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">/</span> <span class="va">y</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Errors: 0.022406165 0.011063517 0.007527112 0.005673638 0.004462547</span></span>
<span><span class="co">## [1] 0.9973072 0.9896224 1.0073716 1.0100591 0.9987420</span></span></code></pre>
<p>The method assigns or retrieves a vector of uncertainties, which is
stored as an attribute of the class , along with a unique object
identifier:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  Errors: num [1:5] 0.99(1) 1.98(1) 3.01(1) 4.01(1) 5.00(1)</span></span></code></pre>
<p>Correlations (and thus covariances) between pairs of variables can be
set and retrieved using the and methods. These correlations are stored
in an internal hash table indexed by the unique object identifier
assigned to each object. If an object is removed, its associated
correlations are cleaned up automatically.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/correl.html">correl</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">x</span><span class="op">)</span> <span class="co"># one, cannot be changed</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1 1 1 1 1</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/correl.html">correl</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="co"># NULL, not defined yet</span></span></code></pre></div>
<pre><code><span><span class="co">## NULL</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/correl.html">correl</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/correl.html">correl</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -0.1193340 -0.6327948  0.7335907 -0.7196349  0.9496746</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/correl.html">covar</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -2.386679e-05 -1.265590e-04  1.467181e-04 -1.439270e-04  1.899349e-04</span></span></code></pre>
<p>Internally, provides S3 methods for the generics belonging to the
groups and , which propagate the uncertainty and the covariance using
Equations <span class="math inline">\(\eqref{eq:prop-var}\)</span> and
<span class="math inline">\(\eqref{eq:prop-covar}\)</span>
respectively.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="co"># previous computation without correlations</span></span></code></pre></div>
<pre><code><span><span class="co">## Errors: 0.022406165 0.011063517 0.007527112 0.005673638 0.004462547</span></span>
<span><span class="co">## [1] 0.9973072 0.9896224 1.0073716 1.0100591 0.9987420</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">z_correl</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">/</span> <span class="va">y</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Errors: 0.023452968 0.013592361 0.004853196 0.007114124 0.002184765</span></span>
<span><span class="co">## [1] 0.9973072 0.9896224 1.0073716 1.0100591 0.9987420</span></span></code></pre>
<p>Other many S3 methods are also provided, such as generics belonging
to the group, subsetting operators (, , , ), concatenation (),
differentiation (), row and column binding (, ), coercion to list, data
frame and matrix, and more. Such methods mutate the object, and thus
return a new one with no correlations associated. There are also
<em>setters</em> defined as an alternative to the assignment methods (
instead of , and ), primarily intended for their use in conjunction with
the pipe operator () from the package.</p>
<p>Additionally, other useful summaries are provided, namely, the mean,
the weighted mean and the median. The uncertainty of any measurement of
central tendency cannot be smaller than the uncertainty of the
individual measurements. Therefore, the uncertainty assigned to the mean
is computed as the maximum between the standard deviation of the mean
and the mean of the individual uncertainties (weighted, in the case of
the weighted mean). As for the median, its uncertainty is computed as
<span class="math inline">\(\sqrt{\pi/2}\approx1.253\)</span> times the
standard deviation of the mean, where this constant comes from the
asymptotic variance formula .</p>
<p>It is worth noting that both values and uncertainties are stored with
all the digits. However, when a single measurement or a column of
measurements in a data frame are printed, there are S3 methods for and
defined to properly format the output and display a single significant
digit for the uncertainty. This default representation can be overridden
using the option, and it is globally controlled with the option .</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the elementary charge</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/errors.html">set_errors</a></span><span class="op">(</span><span class="fl">1.6021766208e-19</span>, <span class="fl">0.0000000098e-19</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">e</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 1.6021766208(98)e-19</span></span></code></pre>
<p>The notation, in which <em>the number in parentheses is the
uncertainty referred to the corresponding last digits of the quantity
value</em> (scheme 2 from the GUM, widely used in physics due to its
compactness), is used by default, but this can be overridden through the
appropriate option in order to use the notation instead.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>errors.notation <span class="op">=</span> <span class="st">"plus-minus"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">e</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## (1.6021766208 ± 0.0000000098)e-19</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>errors.notation <span class="op">=</span> <span class="st">"parenthesis"</span><span class="op">)</span></span></code></pre></div>
<p>Finally, also facilitates plotting of error bars. In the following,
we first assign a 2% of uncertainty to all the numeric variables in the
data set and then we plot it using base graphics and . The result is
shown in Figure <span class="math inline">\(\ref{plot}\)</span>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris.e</span> <span class="op">&lt;-</span> <span class="va">iris</span></span>
<span><span class="va">iris.e</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">iris.e</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/errors.html">set_errors</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">x</span><span class="op">*</span><span class="fl">0.02</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">iris.e</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span><span class="co">## 1       5.1(1)     3.50(7)      1.40(3)    0.200(4)  setosa</span></span>
<span><span class="co">## 2       4.9(1)     3.00(6)      1.40(3)    0.200(4)  setosa</span></span>
<span><span class="co">## 3      4.70(9)     3.20(6)      1.30(3)    0.200(4)  setosa</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">Sepal.Length</span>, <span class="va">iris.e</span>, col<span class="op">=</span><span class="va">Species</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="fl">6.2</span>, <span class="fl">4.4</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">iris.e</span><span class="op">[[</span><span class="st">"Species"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, col<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">iris.e</span><span class="op">[[</span><span class="st">"Species"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, pch<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris.e</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Sepal.Length</span>, <span class="va">Sepal.Width</span>, color<span class="op">=</span><span class="va">Species</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/geom_errors.html">geom_errors</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<embed src="includes/rjournal-plot.pdf" title="Base plot with error bars (left) and \pkg{ggplot2}'s version (right).\label{plot}" width="100%" type="application/pdf"></embed><p class="caption">
Base plot with error bars (left) and ’s version (right).
</p>
</div>
<p>In base graphics, the error bars are automatically plotted when an
object of class is passed. Additionally, we provide the convenience
functions and for obtaining the boundaries of the interval in and other
plotting packages, instead of writing and respectively.</p>
</div>
<div class="section level3">
<h3 id="example-simultaneous-resistance-and-reactance-measurement">Example: Simultaneous resistance and reactance measurement<a class="anchor" aria-label="anchor" href="#example-simultaneous-resistance-and-reactance-measurement"></a>
</h3>
<p>From Annex H.2 of the GUM :</p>
<blockquote>
<p>The resistance <span class="math inline">\(R\)</span> and the
reactance <span class="math inline">\(X\)</span> of a circuit element
are determined by measuring the amplitude <span class="math inline">\(V\)</span> of a sinusoidally-alternating potential
difference across its terminals, the amplitude <span class="math inline">\(I\)</span> of the alternating current passing
through it, and the phase-shift angle <span class="math inline">\(\phi\)</span> of the alternating potential
difference relative to the alternating current.</p>
</blockquote>
<p>The measurands (resistance <span class="math inline">\(R\)</span>,
reactance <span class="math inline">\(X\)</span> and impedance <span class="math inline">\(Z\)</span>) are related to the input quantities
(<span class="math inline">\(V\)</span>, <span class="math inline">\(I\)</span>, <span class="math inline">\(phi\)</span>) by the Ohm’s law:</p>
<p><span class="math display">\[\begin{equation}
  R = \frac{V}{I}\cos\phi; \qquad X = \frac{V}{I}\sin\phi; \qquad Z =
\frac{V}{I}
\end{equation}\]</span></p>
<p>Five simultaneous observations for each input variable are provided
(Table H.2 of the GUM), which are included in as dataset . First, we
need to obtain the mean input values and set the correlations from the
measurements. Then, we compute the measurands and examine the
correlations between them. The results agree with those reported in the
GUM:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">V</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="../reference/errors.html">set_errors</a></span><span class="op">(</span><span class="va">GUM.H.2</span><span class="op">$</span><span class="va">V</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">I</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="../reference/errors.html">set_errors</a></span><span class="op">(</span><span class="va">GUM.H.2</span><span class="op">$</span><span class="va">I</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">phi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="../reference/errors.html">set_errors</a></span><span class="op">(</span><span class="va">GUM.H.2</span><span class="op">$</span><span class="va">phi</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/correl.html">correl</a></span><span class="op">(</span><span class="va">V</span>, <span class="va">I</span><span class="op">)</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">GUM.H.2</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">V</span>, <span class="va">I</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/correl.html">correl</a></span><span class="op">(</span><span class="va">V</span>, <span class="va">phi</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">GUM.H.2</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">V</span>, <span class="va">phi</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/correl.html">correl</a></span><span class="op">(</span><span class="va">I</span>, <span class="va">phi</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">GUM.H.2</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">I</span>, <span class="va">phi</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">R</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">V</span> <span class="op">/</span> <span class="va">I</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">phi</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span>, notation <span class="op">=</span> <span class="st">"plus-minus"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 127.732 ± 0.071</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">X</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">V</span> <span class="op">/</span> <span class="va">I</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">phi</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">3</span>, notation <span class="op">=</span> <span class="st">"plus-minus"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 219.847 ± 0.296</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">V</span> <span class="op">/</span> <span class="va">I</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">3</span>, notation <span class="op">=</span> <span class="st">"plus-minus"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 254.260 ± 0.236</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/correl.html">correl</a></span><span class="op">(</span><span class="va">R</span>, <span class="va">X</span><span class="op">)</span>; <span class="fu"><a href="../reference/correl.html">correl</a></span><span class="op">(</span><span class="va">R</span>, <span class="va">Z</span><span class="op">)</span>; <span class="fu"><a href="../reference/correl.html">correl</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Z</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -0.5884298</span></span></code></pre>
<pre><code><span><span class="co">## [1] -0.4852592</span></span></code></pre>
<pre><code><span><span class="co">## [1] 0.9925116</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="example-calibration-of-a-thermometer">Example: Calibration of a thermometer<a class="anchor" aria-label="anchor" href="#example-calibration-of-a-thermometer"></a>
</h3>
<p>From Annex H.3 of the GUM :</p>
<blockquote>
<p>A thermometer is calibrated by comparing <span class="math inline">\(n=11\)</span> temperature readings <span class="math inline">\(t_k\)</span> of the thermometer […] with
corresponding known reference temperatures <span class="math inline">\(t_{R,k}\)</span> in the temperature range 21 <span class="math inline">\(^\circ\)</span>C to 27 <span class="math inline">\(^\circ\)</span>C to obtain the corrections <span class="math inline">\(b_k=t_{R,k}-t_k\)</span> to the readings.</p>
</blockquote>
<p>Measured temperatures and corrections (Table H.6 of the GUM), which
are included in as dataset , are related by a linear calibration
curve:</p>
<p><span class="math display">\[\begin{equation}
  b(t) = y_1 + y_2 (t - t_0)
\end{equation}\]</span></p>
<p>In the following, we first fit the linear model for a reference
temperature <span class="math inline">\(t_0=20\)</span> <span class="math inline">\(^\circ\)</span>C. Then, we extract the
coefficients, and assign the uncertainty and correlation between them.
Finally, we compute the predicted correction <span class="math inline">\(b(30)\)</span>, which agrees with the value
reported in the GUM:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">bk</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">tk</span> <span class="op">-</span> <span class="fl">20</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">GUM.H.3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/errors.html">set_errors</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/errors.html">set_errors</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/correl.html">covar</a></span><span class="op">(</span><span class="va">y1</span>, <span class="va">y2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">b.30</span> <span class="op">&lt;-</span> <span class="va">y1</span> <span class="op">+</span> <span class="va">y2</span> <span class="op">*</span> <span class="fu"><a href="../reference/errors.html">set_errors</a></span><span class="op">(</span><span class="fl">30</span> <span class="op">-</span> <span class="fl">20</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span>, notation <span class="op">=</span> <span class="st">"plus-minus"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## -0.1494 ± 0.0041</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="discussion">Discussion<a class="anchor" aria-label="anchor" href="#discussion"></a>
</h2>
<p>The package provides the means for defining numeric vectors, matrices
and arrays with errors in R, as well as to operate with them in a
transparent way. Propagation of uncertainty implements the commonly used
first-order TSM formula from Equation <span class="math inline">\(\eqref{eq:prop-law}\)</span>. This method has been
pre-computed and expanded for each operation in the S3 groups and ,
instead of differentiating symbolic expressions on demand or using
functions from other packages for this task. The advantages of this
approach are twofold. On the one hand, it is faster, as it does not
involve simulation nor symbolic computation, and very lightweight in
terms of package dependencies.</p>
<p>Another advantage of is the built-in consistent and formally sound
representation of measurements with errors, rounding the uncertainty to
one significant digit by default and supporting two widely used
notations: (e.g., <span class="math inline">\(5.00(1)\)</span>) and
(e.g., <span class="math inline">\(5.00 \pm 0.01\)</span>). These
notations are applied for single numbers and data frames, as well as
data frames from the package.</p>
<p>Full support is provided for both and , as well as matrices and
arrays. However, some operations on those data structures may drop
uncertainties (i.e., object class and attributes). More specifically,
there are six common <em>data wrangling</em> operations: row subsetting,
row ordering, column transformation, row aggregation, column joining and
(un)pivoting. Table <span class="math inline">\(\ref{tab:compat}\)</span> shows the correspondence
between these operations and R base functions, as well as the
compatibility with .</p>
<p>Overall, is fully compatible with data wrangling operations embed in
R base, and this is because those functions are mainly based on the
subsetting generics, for which provides the corresponding S3 methods.
Nonetheless, special attention must be paid to aggregations, which store
partial results in lists that are finally simplified. Such
simplification is made with , which drops all the input attributes,
including custom classes. However, all these aggregation functions
provide the argument (sometimes ), which if set to , prevents this
destructive simplification, and lists are returned. Such lists can be
simplified <em>non-destructively</em> by calling .</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unlist</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">is.list</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">c</span>, <span class="va">x</span><span class="op">)</span> <span class="kw">else</span> <span class="va">x</span></span>
<span><span class="va">iris.e.agg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">Species</span>, data <span class="op">=</span> <span class="va">iris.e</span>, <span class="va">mean</span>, simplify<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">iris.e.agg</span>, <span class="va">unlist</span><span class="op">)</span>, col.names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">iris.e.agg</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      Species Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span><span class="co">## 1     setosa       5.0(1)     3.43(7)      1.46(3)     0.25(1)</span></span>
<span><span class="co">## 2 versicolor       5.9(1)     2.77(6)      4.26(9)     1.33(3)</span></span>
<span><span class="co">## 3  virginica       6.6(1)     2.97(6)       5.6(1)     2.03(4)</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="summary-and-future-work">Summary and future work<a class="anchor" aria-label="anchor" href="#summary-and-future-work"></a>
</h2>
<p>We have introduced , a lightweight R package for managing numeric
data with associated standard uncertainties. The new class provides
numeric operations with automated propagation of uncertainty through a
first-order TSM, and a formally sound representation of measurements
with errors. Using this package makes the process of computing indirect
measurements easier and less error-prone.</p>
<p>Future work includes importing and exporting data with uncertainties
and providing the user with an interface for plugging uncertainty
propagation methods from other packages. Finally, enables ongoing
developments for integrating and uncertainty handling into a complete
solution for quantity calculus. Having a unified workflow for managing
measurements with units and errors would be an interesting addition to
the R ecosystem with very few precedents in other programming
languages.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Iñaki Ucar.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
